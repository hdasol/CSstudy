# HTTP / HTTPS

## 동현

### HTTP란 무엇인가요?

HTTP란, 서버와 클라이언트간에 `데이터를 주고 받기 위해 사용하는 프로토콜`입니다. HTTP Header, Message Body 등을 이용해 요청 및 응답을 합니다.

### HTTPS는 무엇이고, 왜 사용하나요?

HTTP는 통신에 주고받는 데이터가 암호화 되지 않는다는 단점이 있었습니다. 따라서, 민감한 정보의 탈취에 쉽게 대응하지 못했습니다. HTTPS는 `SSL`(Secure Socket Layer) 기술을 이용해 전송되는 데이터를 네트워크 상에서 `암호화`시켜 보안성을 높이고, `인증서 인증`을 통해 신뢰할 수 있는 서버와의 통신을 할 수 있도록 합니다. 암호화/복호화 혹은 인증서 발급 및 유지를 하기 위한 추가 비용이 발생하지만, 데이터의 보안이 더 중요하기 때문에 사용합니다.

### HTTPS가 데이터를 암호화하는 방식은?

`대칭키 암호화`와 `비대칭키 암호화`방식을 모두 사용합니다. 비대칭키 암호화 방식을 이용해 대칭키를 공유하고 (그냥 대칭키를 여과없이 공유하면 다 노출되니깐 위험함), 그 대칭키를 이용해 주고받을 데이터를 암호화 및 복호화합니다.

이는, `대칭키 암호화의 단점인 보안에 취약하다`는 점을 비대칭키 암호화가 보완한 방식이고, 반대로 `비대칭키 암호화의 단점인 CPU 리소스를 많이 잡아먹어 속도가 느릴 수 있는 문제`를 대칭키 암호화 방식으로 보완한 것입니다.

### 대칭키 암호화 / 비대칭키 암호화(RSA 알고리즘)

대칭키란, 데이터의 암호화를 위한 키와 복호화를 위한 키가 `동일한`것입니다. 서버와 클라이언트가 대칭키를 공유하며, 공유하는 과정에서 대칭키가 탈취당한다면 누구든 암호화된 데이터를 읽을 수 있어 보안적으로 약한 방식입니다.

비대칭키란, 데이터의 암호화를 위한 키와 복호화를 위한 키가 `각각 따로`존재하는 경우입니다. 클라이언트 및 서버 각각 자신만의 `공개키`와 `비밀키`를 가지고 있습니다. 하나의 키로 암호화를 했다면, 남은 키로 복호화를 할 수 있습니다. SSL 방식에서는 데이터를 수신하는 곳의 `공개키로 암호화`를 진행하며, 수신자는 자신의 `비밀키로 복호화`를 진행합니다. 비밀키는 자신의 컴퓨터에 저장되어 있으므로 쉽게 노출되지 않기 때문에 보안적으로 안전하지만, 복잡한 수학적 원리로 암호화가 진행되기 때문에 `CPU 리소스`를 많이 잡아먹는다는 문제가 있습니다.

(따라서, 이 둘의 단점을 서로 보완하기 위해 함께 사용해 암호화를 진행합니다.)

### 인증서

`서버가 신뢰할 수 있는 서버`인지를 증명하기 위해 필요한 것입니다. CA(Certificate Authority)라는 인증서 발급 기관에 서버의 `도메인`, `공개키`등 필요한 정보를 넘겨줍니다. CA는 넘겨 받은 공개키를 (SHA-256 등으로) 해시하여 `지문(FingerPrint)`으로, 이 지문을 CA 자신의 `비밀키`로 암호화해서 `서명(Signature)`로 정보를 만듭니다. 이 정보들은 만들어질 인증서에 담겨, 인증서 발급을 원했던 서버로 돌아가게 됩니다. (이 외에도 인증서를 발급한 CA, 만료기간, 해시 알고리즘 등이 인증서에 포함된다!)

+) 참고: 인증서 체인  
상위 인증기관의 비밀키로 하위 인증기간의 공개키를 암호화하고, 이와 같은 동작이 연쇄적으로 일어나는 것을 인증서 체인이라고 합니다.

+) 참고 : 사설 인증서  
신뢰할 수 없는 사이트 뜨는게 사설 인증서로 SSL 통신하는 경우

### 클라이언트가 서버 인증서의 무결성을 입증하는 방식?

윈도우 기준으로, 각 브라우저는 CA기관과 해당 기관의 공개키를 가지고 있습니다. 클라이언트가 서버로 접속하기 위해 https 프로토콜을 이용한 통신을 시작하면, 서버는 우선 자신의 인증서를 클라이언트에게 전달합니다. 인증서의 `서명`을 브라우저가 가지고 있는 해당 인증서의 발급 기관(CA)의 `공개키`로 복호화 한 결과가, 인증서의 `지문`과 일치한다면 위조되지 않은 인증서라고 판단합니다. (또한, 인증서 지문 및 서명의 복호화 결과는 서버의 공개키입니다. 따라서, 해당 공개키를 이용해 대칭키를 서버로 전달할 수 있고, 서버는 자신의 비밀키로 복호화해 클라이언트와 서버가 대칭키를 공유하게 됩니다. 암호화를 이용한 통신이 이루어지기 시작하는 것입니다.)

### 참고자료

- [HTTP와 HTTPS의 개념 및 차이점](https://mangkyu.tistory.com/98)
- [HTTP vs HTTPS 차이](https://blog.wishket.com/http-vs-https-%EC%B0%A8%EC%9D%B4-%EC%95%8C%EB%A9%B4-%EC%82%AC%EC%9D%B4%ED%8A%B8%EC%9D%98-%EB%A0%88%EB%B2%A8%EC%9D%B4-%EB%B3%B4%EC%9D%B8%EB%8B%A4/)
- [SSL(TLS) 암호화 방식](https://babbab2.tistory.com/4)
- [인증서, CA](https://babbab2.tistory.com/5?category=960153)
